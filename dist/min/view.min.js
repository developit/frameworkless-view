!function(a){"function"==typeof define&&define.amd?define(["util","events","zepto","handlebars"],a):a(window.util,window.EventEmitter,$,handlebars)}(function(a,b,c,d){function e(a,b,c,d){return a?(a._eventRegistry||(a._eventRegistry=[]),a._eventTypes||(a._eventTypes={}),a._eventTypes.hasOwnProperty(b)||(a.addEventListener(b,f),a._eventTypes[b]=!0),void a._eventRegistry.push({type:b,selector:c,callback:d})):!1}function f(a){var b,c,d,e=this._eventRegistry.filter(function(b){return b.type===a.type?!0:!1});d=a.target||a.srcElement;do{for(b=e.length;b--;){var f;if(c=e[b],d.matches(c.selector)&&(f=c.callback.call(d,a),f===!1))return!1}d=d.parentNode}while(d!==this)}function g(a,b){return this instanceof g?(this.rawView=a,this.doTemplate=d.compile(this.rawView),this.base=document.createElement("div"),this.base.setAttribute("id",b+"-base"),this.base.classList.add("view-base"),this.base.innerHTML="",this.name=b,void(this.name&&this.base.setAttribute("data-view",b))):new g(a,b)}var h=b.EventEmitter||b;a=a||c,Element.prototype.matches=Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||i;var i=function(a){var b,c=document.querySelectorAll(a);for(b=c.length;b--;)if(c[b]===this)return!0;return!1},j=Element.prototype;return j.matches=j.matches||j.webkitMatchesSelector||j.mozMatchesSelector||j.oMatchesSelector||function(a){for(var b=document.querySelectorAll(a),c=b.length;c--;)if(b[c]===this)return!0;return!1},a.inherits(g,h),a.extend(g.prototype,{template:function(a){return this.doTemplate?(this.templateData=a,this.base.innerHTML=a&&this.doTemplate(a)||this.rawView,this):!1},hookEvents:function(a){var b,c,d,f;if(this.base){this.events=a;for(f in a)a.hasOwnProperty(f)&&(b=f.split(" "),c=b[0],d=b.slice(1).join(" "),e(this.base,c,d,a[f]));return this}return!1},insertInto:function(a){if(this.base){var b=document.querySelector(a);b.appendChild(this.base)}return this},insertAfter:function(a){if(this.base){var b=document.querySelector(a);this.base.insertBefore(b,this.base.nextSibling)}return this}}),g.View=g.view=g,g});
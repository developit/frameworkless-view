!function(a){"function"==typeof define&&define.amd?define(["util","events","handlebars"],a):a(window.util,window.EventEmitter,$,handlebars)}(function(a,b,c){function d(a,b,c,d){return a&&b&&c&&d?(a._eventRegistry||(a._eventRegistry=[]),a._eventTypes||(a._eventTypes={}),a._eventTypes.hasOwnProperty(b)||(a.addEventListener(b,e),a._eventTypes[b]=!0),a._eventRegistry.push({type:b,selector:c,callback:d}),!0):!1}function e(a){var b,c,d,e=this._eventRegistry.filter(function(b){return b.type===a.type?!0:!1});d=a.target||a.srcElement;do for(b=e.length;b--;)if(c=e[b],i.call(d,c.selector)&&c.callback.call(d,a)===!1)return!1;while((d=d.parentNode)!==this.parentNode)}function f(a,b){return this instanceof f?(this.rawView=a,this.renderTemplate=c.compile(this.rawView),this.base=document.createElement("div"),b&&this.base.setAttribute("id",b+"-base"),this.base.className="view-base",this.base.innerHTML=this.rawView,this.name=b,void(this.name&&this.base.setAttribute("data-view",b))):new f(a,b)}var g=b.EventEmitter||b;a=a||$;var h=Element.prototype,i=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||function(a){for(var b=document.querySelectorAll(a),c=b.length;c--;)if(b[c]===this)return!0;return!1};return a.inherits(f,g),a.extend(f.prototype,{template:function(a){return this.renderTemplate?(this.templateData=a,this.base.innerHTML=a&&this.renderTemplate(a)||this.rawView,this):!1},hookEvents:function(a){var b,c,e,f;if(this.base){this.events=a;for(f in a)if(a.hasOwnProperty(f)&&(b=f.split(" "),c=b[0],e=b.slice(1).join(" "),!d(this.base,c,e,a[f])))throw new Error("Invalid events object.");return this}return!1},insertInto:function(a){if(!this.base)throw new Error("Cannot insert view prior to initialization");return"string"==typeof a&&(a=document.querySelector(a)),a.appendChild(this.base),this},insertAfter:function(a){return this.base&&("string"==typeof a&&(a=document.querySelector(a)),a.parentNode.insertBefore(this.base,a.nextSibling)),this},find:function(a){return Array.prototype.slice.call(this.base.querySelectorAll(a))},findOne:function(a){return this.base.querySelector(a)},$:function(a){return this.find(a)},$$:function(a){return this.findOne(a)}}),f.View=f.view=f,f});